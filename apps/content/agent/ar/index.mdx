---
title: العميل
description: نظام شامل للأتمتة والذكاء الاصطناعي الذي يشغّل منصة الاستثمار الزراعي لنيويولك. يتعامل نظام العميل مع العمليات التجارية ومزامنة بيانات المزارع وتوزيع الإيرادات والإشعارات والتحليلات من خلال هيكلية موزعة مدفوعة بالأحداث.
---

## نظرة عامة

يعمل نظام عميل نيويولك كعمود فقري ذكي للأتمتة في منصة الاستثمار الزراعي، حيث ينسق العمليات التجارية المعقدة بين عمليات المزرعة الفعلية وإدارة الاستثمار الرقمي. مع قدرات المعالجة الموزعة عبر رومانيا والعراق، يضمن النظام المزامنة السلسة في الوقت الفعلي لبيانات المزرعة والحسابات الآلية للإيرادات والمشاركة الذكية للعملاء.

تم بناؤه بهيكلية خدمات مصغرة حديثة، يقدم نظام العميل أتمتة شاملة تشمل معالجة الاستثمار ومراقبة عمليات المزرعة وإدارة دورة حياة العملاء وذكاء الأعمال.

## هيكلية العميل

النظام منظم كشبكة عميل موزعة مع ستة وحدات رئيسية، كل منها تتعامل مع وظائف أتمتة محددة:

### `/agents/investment` - نظام معالجة الاستثمار
**التكنولوجيا**: Node.js مع TypeScript  
**الغرض**: إدارة الاستثمار الآلية وعمليات المحفظة

#### وحدة معالجة الشراء
- **التحقق من الاستثمار**: التحقق من معاملات الاستثمار في الوقت الفعلي وتقييم المخاطر
- **معالجة الدفع**: تكامل بوابة الدفع الآلية وإدارة المعاملات
- **تخصيص الدجاج**: تعيين الدجاج الديناميكي بناءً على سعة المزرعة وتفضيلات العملاء
- **تحديثات المحفظة**: مزامنة وتتبع محفظة العملاء في الوقت الفعلي

#### وحدة إدارة المحفظة
- **مراقبة الأداء**: تتبع وتحليل أداء الاستثمار المستمر
- **أتمتة إعادة التوازن**: تحسين المحفظة الذكي بناءً على ظروف السوق
- **تقييم المخاطر**: تقييم المخاطر الآلي واستراتيجيات التخفيف
- **معالجة التجديد**: إدارة تجديد وتوسيع الاستثمار الآلي

### `/agents/revenue` - نظام توزيع الإيرادات
**التكنولوجيا**: Node.js مع TypeScript  
**الغرض**: حساب الإيرادات الآلي وتوزيع الأرباح

#### الميزات الأساسية
- **تتبع مبيعات الصفار**: مراقبة إنتاج ومبيعات الصفار من المزارع في الوقت الفعلي
- **حساب الإيرادات**: حساب الأرباح الآلي بناءً على بيانات الإنتاج
- **معالجة التوزيع**: توزيع الأرباح الذكي على محافظ المستثمرين
- **تحليلات الأداء**: تحليل اتجاهات الإيرادات والتنبؤ
- **الامتثال الضريبي**: حساب الضرائب الآلي والإبلاغ للولايات القضائية المختلفة
- **جدولة المدفوعات**: إدارة تكرار الدفع المرن (يومي/أسبوعي/شهري)

### `/agents/farm-sync` - مزامنة بيانات المزرعة
**التكنولوجيا**: Node.js مع TypeScript  
**الغرض**: التكامل في الوقت الفعلي مع عمليات المزارع الرومانية والعراقية

#### القدرات الرئيسية
- **مراقبة الإنتاج**: تتبع مباشر لإنتاجية الدجاج ومقاييس الصحة
- **البيانات البيئية**: مراقبة الطقس ودرجة الحرارة وحالة المرافق
- **إدارة العلف**: تتبع استهلاك العلف الآلي والتحسين
- **المراقبة الصحية**: اكتشاف الأمراض وأنظمة تنبيه البيطريين
- **حالة المعدات**: مراقبة معدات المزرعة وجدولة الصيانة
- **تتبع الامتثال**: مراقبة الامتثال التنظيمي لكلا السوقين

### `/agents/notification` - الاتصال متعدد القنوات
**التكنولوجيا**: Node.js مع TypeScript  
**الغرض**: الإشعارات الذكية وإدارة الاتصالات

#### الميزات
- **التوجيه الذكي**: تحسين تسليم الإشعارات حسب السياق
- **إدارة القنوات**: تنسيق تليجرام والبريد الإلكتروني والرسائل النصية والإشعارات الفورية
- **التخصيص**: تخصيص المحتوى المدفوع بالذكاء الاصطناعي بناءً على سلوك المستخدم
- **تتبع التسليم**: تحليلات شاملة لتسليم الإشعارات
- **محرك القوالب**: توليد محتوى ديناميكي لأنواع مختلفة من الإشعارات
- **منطق التصعيد**: التصعيد الآلي للإشعارات الحرجة

### `/agents/analytics` - نظام ذكاء الأعمال
**التكنولوجيا**: Node.js مع TypeScript  
**الغرض**: معالجة البيانات في الوقت الفعلي ورؤى الأعمال

#### المكونات الأساسية
- **خط أنابيب البيانات**: عمليات ETL لبيانات المزرعة والاستثمار
- **مقاييس الأداء**: حساب وتتبع مؤشرات الأداء الرئيسية
- **التحليلات التنبؤية**: نماذج التعلم الآلي للاستثمار والتنبؤ بالإنتاج
- **رؤى العملاء**: التحليل السلوكي والتجزئة
- **تحليل السوق**: تحليل اتجاهات السوق الزراعي والإبلاغ
- **تقارير الامتثال**: توليد التقارير التنظيمية والتدقيق الآلي

### `/agents/compliance` - الإدارة التنظيمية
**التكنولوجيا**: Node.js مع TypeScript  
**الغرض**: مراقبة الامتثال الآلية وإدارة التدقيق

#### الميزات الرئيسية
- **المراقبة التنظيمية**: فحص الامتثال في الوقت الفعلي للوائح الرومانية والعراقية
- **مسار التدقيق**: تسجيل شامل للمعاملات والعمليات
- **إدارة المخاطر**: تقييم المخاطر الآلي والتخفيف
- **إدارة الوثائق**: توليد وحفظ وثائق الامتثال الآلي
- **نظام التنبيه**: اكتشاف انتهاكات الامتثال الاستباقي والإخطار
- **محرك التقارير**: توليد وتقديم التقارير التنظيمية الآلي

## البدء

### المتطلبات المسبقة
- Node.js 18+ 
- Redis (للتخزين المؤقت والطوابير)
- PostgreSQL (للتخزين المستمر)
- Docker (للحاويات)
- PM2 (لإدارة العمليات)

### إعداد نظام العميل

1. **استنساخ المستودع**
   ```bash
   npx degit daltonmenezes/newyolk اسم_مشروعك
   cd اسم_مشروعك
   ```

2. **تثبيت التبعيات**
   ```bash
   pnpm install
   ```

3. **بدء نظام العميل**
   ```bash
   # بدء جميع العملاء في نفس الوقت
   pnpm agent:dev

   # أو بدء وحدات العميل الفردية
   pnpm agent:investment     # معالجة الاستثمار
   pnpm agent:revenue        # توزيع الإيرادات
   pnpm agent:farm-sync      # مزامنة المزرعة
   pnpm agent:notification   # نظام الإشعارات
   pnpm agent:analytics      # معالجة التحليلات
   pnpm agent:compliance     # مراقبة الامتثال
   ```

4. **مراقبة عمليات العميل**
   - لوحة التحكم: [http://localhost:4000](http://localhost:4000)
   - فحص الصحة: [http://localhost:4001/health](http://localhost:4001/health)
   - المقاييس: [http://localhost:4002/metrics](http://localhost:4002/metrics)
   - السجلات: واجهة مراقبة PM2

### إعداد البيئة
يتطلب نظام العميل تكوين بيئة شامل:

```bash
# تكوين نظام العميل
### ! النظام الأساسي ! ##########################################
NODE_ENV=development
AGENT_PORT=4000
AGENT_CLUSTER_SIZE=4
LOG_LEVEL=info

# ? تكوين Redis
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=كلمة_مرور_سرية

# ? تكوين الطابور
BULL_REDIS_URL=redis://localhost:6379/1
QUEUE_CONCURRENCY=10

# ? تكوين قاعدة البيانات
DATABASE_URL=postgresql://user:pass@localhost:5432/agents
DATABASE_POOL_SIZE=20

### ! عميل الاستثمار ! ###################################
INVESTMENT_PROCESSING_INTERVAL=30000
MAX_INVESTMENT_AMOUNT=10000
MIN_INVESTMENT_AMOUNT=50
PORTFOLIO_REBALANCE_CRON=0 2 * * *

### ! عميل الإيرادات ! #####################################
REVENUE_CALCULATION_CRON=0 6 * * *
PAYOUT_PROCESSING_CRON=0 8 * * *
REVENUE_DISTRIBUTION_FEE=0.05

### ! عميل مزامنة المزرعة ! ##################################
ROMANIA_FARM_API_URL=https://ro-farm.newyolk.io/api
IRAQ_FARM_API_URL=https://iq-farm.newyolk.io/api
FARM_SYNC_INTERVAL=60000
FARM_API_KEY=مفتاح_سري

### ! عميل الإشعارات ! ###############################
NOTIFICATION_RATE_LIMIT=1000
EMAIL_QUEUE_CONCURRENCY=50
PUSH_NOTIFICATION_BATCH_SIZE=100

# ? تكوين تليجرام
TELEGRAM_BOT_TOKEN=رمز_سري
TELEGRAM_WEBHOOK_URL=https://agent.newyolk.io/webhook/telegram

# ? تكوين البريد الإلكتروني (SendGrid)
SENDGRID_API_KEY=مفتاح_سري
SENDGRID_FROM_EMAIL=noreply@newyolk.io

# ? تكوين الرسائل النصية (Twilio)
TWILIO_ACCOUNT_SID=معرف_سري
TWILIO_AUTH_TOKEN=رمز_سري
TWILIO_PHONE_NUMBER=+1234567890

### ! عميل التحليلات ! ##################################
ANALYTICS_BATCH_SIZE=1000
ANALYTICS_PROCESSING_CRON=*/15 * * * *
ML_MODEL_UPDATE_CRON=0 3 * * 0

# ? تحليلات PostHog
POSTHOG_API_KEY=مفتاح_سري
POSTHOG_HOST=https://app.posthog.com

### ! عميل الامتثال ! #################################
COMPLIANCE_CHECK_CRON=0 1 * * *
AUDIT_LOG_RETENTION_DAYS=2555
REGULATORY_ALERT_THRESHOLD=0.95

# ? واجهات برمجة التطبيقات الخارجية للامتثال
ROMANIA_REGULATORY_API=https://anaf.ro/api
IRAQ_REGULATORY_API=https://tax.gov.iq/api
COMPLIANCE_API_KEYS=مفاتيح_سرية
```

## مجموعة التكنولوجيا

### التكنولوجيات الأساسية
- **وقت التشغيل**: Node.js 18+ مع TypeScript
- **مدير العمليات**: PM2 للتجميع والمراقبة
- **طابور الرسائل**: Bull/BullMQ مع خلفية Redis
- **قاعدة البيانات**: PostgreSQL مع Prisma ORM
- **التخزين المؤقت**: Redis للتخزين المؤقت عالي الأداء
- **المراقبة**: مجموعة Prometheus + Grafana

### تكنولوجيات خاصة بالعميل
- **الاستثمار**: SDKs لـ Stripe/PayPal، مكتبات الحساب المالي
- **الإيرادات**: Decimal.js للحسابات المالية الدقيقة، توليد PDF
- **مزامنة المزرعة**: اتصالات WebSocket، تكاملات أجهزة إنترنت الأشياء
- **الإشعارات**: Firebase Cloud Messaging، Telegram Bot API، SendGrid
- **التحليلات**: TensorFlow.js، Apache Spark، ClickHouse
- **الامتثال**: مكتبات تحليل PDF، أدوات توليد الوثائق

## أتمتة العمليات التجارية

ينظم نظام العميل العمليات التجارية الحرجة عبر دورة حياة الاستثمار الزراعي:

1. **معالجة الاستثمار**: التحقق الآلي من الشراء ومعالجة الدفع وتخصيص الدجاج
2. **عمليات المزرعة**: مراقبة في الوقت الفعلي لمقاييس الإنتاج والظروف البيئية  
3. **توزيع الإيرادات**: حساب وتوزيع آلي للأرباح من مبيعات الصفار
4. **مشاركة العملاء**: تسليم الإشعارات الذكي وإدارة دورة الحياة
5. **إدارة الامتثال**: مراقبة تنظيمية مستمرة وإبلاغ آلي

## التغطية التشغيلية

- **الأسواق الأساسية**: رومانيا والعراق مع الامتثال المحلي
- **قدرة المعالجة**: أكثر من 10,000 معاملة في الدقيقة
- **قابلية التوسع**: التوسع الأفقي مع تنسيق Kubernetes

## الفوائد الرئيسية

- **الأتمتة**: تقليل 95% في النفقات العامة للمعالجة اليدوية
- **الموثوقية**: وقت التشغيل 99.9% مع أنظمة التبديل الاحتياطي المتكررة
- **قابلية التوسع**: التوسع التلقائي بناءً على طلب العمل
- **الذكاء**: التحسين والرؤى المدفوعة بالتعلم الآلي
- **الامتثال**: الالتزام التنظيمي الآلي عبر الولايات القضائية

## التطوير

### هيكل نظام العميل
```
newyolk/
├── apps/
│   └── agent/         # تطبيق نظام العميل
│       ├── src/
│       │   ├── core/
│       │   │   ├── scheduler/      # إدارة مهام الجدولة الزمنية
│       │   │   ├── queue/          # معالجات طابور الرسائل
│       │   │   ├── events/         # نظام الأحداث
│       │   │   └── monitoring/     # فحوصات الصحة
│       │   ├── agents/
│       │   │   ├── investment/     # معالجة الاستثمار
│       │   │   ├── revenue/        # توزيع الإيرادات
│       │   │   ├── farm-sync/      # مزامنة بيانات المزرعة
│       │   │   ├── notification/   # الإشعارات
│       │   │   ├── analytics/      # ذكاء الأعمال
│       │   │   └── compliance/     # الامتثال التنظيمي
│       │   ├── integrations/
│       │   │   ├── telegram/       # بوت تليجرام
│       │   │   ├── email/          # خدمة البريد الإلكتروني
│       │   │   ├── sms/            # بوابة الرسائل النصية
│       │   │   ├── farms/          # عملاء API المزرعة
│       │   │   └── payments/       # معالجات الدفع
│       │   └── utils/
│       │       ├── logger/         # أدوات التسجيل
│       │       ├── validation/     # التحقق من البيانات
│       │       └── encryption/     # أدوات الأمان
│       ├── config/
│       ├── tests/
│       └── package.json
├── packages/
│   ├── agent-types/   # تعاريف TypeScript الخاصة بالعميل
│   ├── agent-utils/   # أدوات العميل المشتركة
│   └── agent-config/  # إدارة تكوين العميل
└── docker/
    ├── agent.dockerfile
    └── docker-compose.agent.yml
```

### أوامر العميل
```bash
# تثبيت التبعيات لنظام العميل
pnpm install

# تشغيل وحدة عميل محددة
pnpm --filter agent dev:investment
pnpm --filter agent dev:revenue
pnpm --filter agent dev:farm-sync

# تشغيل جميع العملاء في وضع المجموعة
pnpm --filter agent cluster:start
pnpm --filter agent cluster:stop

# مراقبة عمليات العميل
pnpm --filter agent monitor
pnpm --filter agent logs

# إضافة تبعية خاصة بالعميل
pnpm --filter agent add bull
pnpm --filter agent add @types/node
```

### حزم العميل المشتركة
- **`packages/agent-types`**: واجهات TypeScript لاتصال العميل
- **`packages/agent-utils`**: أدوات مشتركة للتسجيل والتحقق والتشفير
- **`packages/agent-config`**: إدارة التكوين ومعالجة البيئة

### المساهمة
1. فرع المستودع
2. إنشاء فرع ميزة العميل
3. تنفيذ وظيفة العميل مع الاختبارات
4. تقديم طلب سحب مع التوثيق

## الترخيص

هذا المشروع مفتوح المصدر ومتاح تحت [رخصة MIT](LICENSE).

## الدعم

لأسئلة نظام العميل أو المشاكل أو المساهمات:
- إنشاء مشكلة على GitHub
- الاتصال بفريق التطوير
- تحقق من ويكي وثائق العميل

---

*نظام عميل نيويولك - الأتمتة الذكية للاستثمار الزراعي*